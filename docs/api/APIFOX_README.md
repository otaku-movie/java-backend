# Apifox æ¥å£æ–‡æ¡£ç”Ÿæˆè¯´æ˜

## æ¦‚è¿°

æœ¬é¡¹ç›®ä½¿ç”¨ SpringDoc OpenAPIï¼ˆSwagger 3ï¼‰ç”Ÿæˆ API æ–‡æ¡£ï¼Œæ”¯æŒå¯¼å…¥åˆ° Apifoxã€‚

**æ–‡æ¡£è®¿é—®åœ°å€**: 

### æ ¹æ®å®é™…è¿è¡Œç¯å¢ƒé€‰æ‹©åœ°å€

**å¦‚æœæœåŠ¡è¿è¡Œåœ¨æœ¬åœ°ï¼ˆlocalhostï¼‰**:
- Swagger UI: http://localhost:8080/swagger-ui.html
- OpenAPI JSON: http://localhost:8080/v3/api-docs
- OpenAPI YAML: http://localhost:8080/v3/api-docs.yaml

**å¦‚æœæœåŠ¡è¿è¡Œåœ¨æµ‹è¯•æœåŠ¡å™¨ï¼ˆ192.168.3.47ï¼‰**:
- Swagger UI: http://192.168.3.47:8080/swagger-ui.html
- OpenAPI JSON: http://192.168.3.47:8080/v3/api-docs
- OpenAPI YAML: http://192.168.3.47:8080/v3/api-docs.yaml

> âš ï¸ **é‡è¦æç¤º**: åœ¨ Apifox ä¸­å¯¼å…¥æ—¶ï¼Œè¯·ç¡®ä¿ä½¿ç”¨**å®é™…è¿è¡ŒæœåŠ¡çš„åœ°å€**ï¼Œè€Œä¸æ˜¯ localhostï¼ˆé™¤é Apifox å’ŒæœåŠ¡å™¨åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼‰ã€‚

---

## 1. è®¿é—® Swagger UI

### 1.1 å¯åŠ¨é¡¹ç›®

```bash
cd java-backend
./mvnw spring-boot:run
```

æˆ–è€…åœ¨ IDEï¼ˆVSCode/IntelliJ IDEAï¼‰ä¸­ï¼š
1. æ‰“å¼€é¡¹ç›®
2. æ‰¾åˆ° `BackendApplication.java`
3. ç‚¹å‡»è¿è¡Œï¼ˆF5 æˆ– Run æŒ‰é’®ï¼‰

**éªŒè¯æœåŠ¡æ˜¯å¦å¯åŠ¨**:
- æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰ "Started BackendApplication" æ—¥å¿—
- æˆ–è€…åœ¨æµè§ˆå™¨è®¿é—® `http://localhost:8080/v3/api-docs` çœ‹æ˜¯å¦æœ‰ JSON å“åº”

### 1.2 è®¿é—® Swagger UI

**å¦‚æœæœåŠ¡è¿è¡Œåœ¨æœ¬æœºï¼ˆlocalhostï¼‰**:
```
http://localhost:8080/swagger-ui.html
```

**å¦‚æœæœåŠ¡è¿è¡Œåœ¨æœåŠ¡å™¨ï¼ˆ192.168.3.47ï¼‰**:
```
http://192.168.3.47:8080/swagger-ui.html
```

> âš ï¸ **å¦‚æœæ— æ³•è®¿é—®**ï¼Œè¯·æ£€æŸ¥ï¼š
> 1. æœåŠ¡æ˜¯å¦å·²å¯åŠ¨ï¼ˆæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼‰
> 2. ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆé»˜è®¤ 8080ï¼‰
> 3. é˜²ç«å¢™æ˜¯å¦å…è®¸ 8080 ç«¯å£è®¿é—®
> 4. æœåŠ¡æ˜¯å¦ç»‘å®šåˆ°æ­£ç¡®çš„åœ°å€ï¼ˆé…ç½®äº† `server.address: 0.0.0.0` å¯ç›‘å¬æ‰€æœ‰æ¥å£ï¼‰

### 1.3 API åˆ†ç»„

- **é€šç”¨æ¥å£**: åŒ…å« `/api/*` æ¥å£ï¼ˆä¸åŒ…æ‹¬ `/api/admin/**` å’Œ `/api/app/**`ï¼‰
- **ç®¡ç†å‘˜æ¥å£**: åŒ…å« `/api/admin/**` æ¥å£
- **App æ¥å£**: åŒ…å« `/api/app/**` æ¥å£
- **æ‰€æœ‰æ¥å£**: åŒ…å«æ‰€æœ‰ `/api/**` æ¥å£

---

## 2. ç”Ÿæˆ OpenAPI æ–‡æ¡£

### 2.1 ä¸‹è½½ OpenAPI JSON

**æ–¹å¼ä¸€ï¼šé€šè¿‡æµè§ˆå™¨**

è®¿é—®ä»¥ä¸‹ URL ä¸‹è½½ JSON æ–‡ä»¶ï¼š

**é»˜è®¤è·¯å¾„ï¼ˆæ‰€æœ‰æ¥å£ï¼‰**:
```
http://localhost:8080/v3/api-docs
# æˆ–ï¼ˆå¦‚æœæœåŠ¡è¿è¡Œåœ¨æµ‹è¯•æœåŠ¡å™¨ï¼‰
http://192.168.3.47:8080/v3/api-docs
```

**æŒ‡å®šåˆ†ç»„**ï¼ˆæ³¨æ„ï¼šä¸­æ–‡åˆ†ç»„åéœ€è¦ URL ç¼–ç ï¼‰:

å¦‚æœæœåŠ¡åœ¨ localhost:
```
http://localhost:8080/v3/api-docs/é€šç”¨æ¥å£
http://localhost:8080/v3/api-docs/ç®¡ç†å‘˜æ¥å£
http://localhost:8080/v3/api-docs/App%20æ¥å£
http://localhost:8080/v3/api-docs/æ‰€æœ‰æ¥å£
```

å¦‚æœæœåŠ¡åœ¨æµ‹è¯•æœåŠ¡å™¨ï¼ˆ192.168.3.47ï¼‰:
```
http://192.168.3.47:8080/v3/api-docs/é€šç”¨æ¥å£
http://192.168.3.47:8080/v3/api-docs/ç®¡ç†å‘˜æ¥å£
http://192.168.3.47:8080/v3/api-docs/App%20æ¥å£
http://192.168.3.47:8080/v3/api-docs/æ‰€æœ‰æ¥å£
```

> ğŸ’¡ **æç¤º**: å¦‚æœä¸­æ–‡è·¯å¾„æ— æ³•è®¿é—®ï¼Œå¯ä»¥ï¼š
> 1. ä½¿ç”¨é»˜è®¤è·¯å¾„ `/v3/api-docs`ï¼ˆåŒ…å«æ‰€æœ‰æ¥å£ï¼‰
> 2. æˆ–è€…ä½¿ç”¨ URL ç¼–ç åçš„è·¯å¾„ï¼ˆæµè§ˆå™¨ä¼šè‡ªåŠ¨ç¼–ç ï¼‰
> 3. æˆ–è€…å…ˆè®¿é—® Swagger UIï¼Œç„¶åä»åœ°å€æ å¤åˆ¶æ­£ç¡®çš„ URL

**æ–¹å¼äºŒï¼šä½¿ç”¨ curl**

```bash
# ä¸‹è½½æ‰€æœ‰æ¥å£çš„ OpenAPI JSON
curl -o openapi.json http://localhost:8080/v3/api-docs/æ‰€æœ‰æ¥å£

# ä¸‹è½½é€šç”¨æ¥å£çš„ OpenAPI JSON
curl -o openapi-common.json http://localhost:8080/v3/api-docs/é€šç”¨æ¥å£

# ä¸‹è½½ç®¡ç†å‘˜æ¥å£çš„ OpenAPI JSON
curl -o openapi-admin.json http://localhost:8080/v3/api-docs/ç®¡ç†å‘˜æ¥å£

# ä¸‹è½½ App æ¥å£çš„ OpenAPI JSON
curl -o openapi-app.json http://localhost:8080/v3/api-docs/App%20æ¥å£
```

**æ–¹å¼ä¸‰ï¼šä½¿ç”¨ Maven æ’ä»¶ï¼ˆæ¨èï¼‰**

åœ¨ `pom.xml` ä¸­æ·»åŠ æ’ä»¶ï¼ˆå·²æ·»åŠ ï¼‰ï¼š

```xml
<plugin>
    <groupId>org.springdoc</groupId>
    <artifactId>springdoc-openapi-maven-plugin</artifactId>
    <version>1.8</version>
    <executions>
        <execution>
            <id>generate-api-docs</id>
            <goals>
                <goal>generate</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <apiDocsUrl>http://localhost:8080/v3/api-docs</apiDocsUrl>
        <outputFileName>openapi.json</outputFileName>
        <outputDir>${project.basedir}/api-docs</outputDir>
    </configuration>
</plugin>
```

è¿è¡Œå‘½ä»¤ç”Ÿæˆæ–‡æ¡£ï¼š

```bash
# å…ˆå¯åŠ¨é¡¹ç›®ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤
./mvnw springdoc-openapi:generate
```

æ–‡æ¡£ä¼šç”Ÿæˆåœ¨ `api-docs/openapi.json`

---

## 3. å¯¼å…¥åˆ° Apifox

### 3.1 æ–¹å¼ä¸€ï¼šé€šè¿‡ URL å¯¼å…¥ï¼ˆæ¨èï¼‰

1. æ‰“å¼€ Apifox å®¢æˆ·ç«¯æˆ–ç½‘é¡µç‰ˆ
2. ç‚¹å‡»"é¡¹ç›®è®¾ç½®" -> "å¯¼å…¥æ•°æ®"
3. é€‰æ‹©"OpenAPI/Swagger"
4. é€‰æ‹©"URL å¯¼å…¥"
5. è¾“å…¥ URLï¼ˆ**é‡è¦ï¼šæ ¹æ®å®é™…è¿è¡Œçš„æœåŠ¡åœ°å€é€‰æ‹©**ï¼‰ï¼š

   **å¦‚æœæœåŠ¡è¿è¡Œåœ¨æœ¬åœ°ï¼ˆlocalhostï¼‰**:
   ```
   http://localhost:8080/v3/api-docs
   ```
   æˆ–æŒ‡å®šåˆ†ç»„ï¼š
   ```
   http://localhost:8080/v3/api-docs/æ‰€æœ‰æ¥å£
   ```

   **å¦‚æœæœåŠ¡è¿è¡Œåœ¨æµ‹è¯•æœåŠ¡å™¨ï¼ˆ192.168.3.47ï¼‰**:
   ```
   http://192.168.3.47:8080/v3/api-docs
   ```
   æˆ–æŒ‡å®šåˆ†ç»„ï¼š
   ```
   http://192.168.3.47:8080/v3/api-docs/æ‰€æœ‰æ¥å£
   ```

   > âš ï¸ **æ³¨æ„**: 
   > - å¦‚æœ Apifox å’ŒæœåŠ¡å™¨ä¸åœ¨åŒä¸€å°æœºå™¨ï¼Œ**ä¸èƒ½ä½¿ç”¨ localhost**ï¼Œå¿…é¡»ä½¿ç”¨å®é™…çš„æœåŠ¡å™¨ IP åœ°å€
   > - å¦‚æœä¸­æ–‡åˆ†ç»„åæ— æ³•è®¿é—®ï¼Œä½¿ç”¨é»˜è®¤è·¯å¾„ `/v3/api-docs`ï¼ˆåŒ…å«æ‰€æœ‰æ¥å£ï¼‰
   > - ç¡®ä¿æœåŠ¡æ­£åœ¨è¿è¡Œï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨å…ˆè®¿é—® Swagger UI éªŒè¯

   æˆ–è€…ä½¿ç”¨æµ‹è¯•ç¯å¢ƒï¼š
   ```
   http://192.168.3.47:8080/v3/api-docs/æ‰€æœ‰æ¥å£
   ```
6. ç‚¹å‡»"å¼€å§‹å¯¼å…¥"

> ğŸ“– **å‚è€ƒæ–‡æ¡£**: [Apifox å¯¼å…¥ OpenAPI/Swagger å®˜æ–¹æ–‡æ¡£](https://docs.apifox.com/doc-5174534)

### 3.1.1 å¯¼å…¥é…ç½®é€‰é¡¹

åœ¨å¯¼å…¥è¿‡ç¨‹ä¸­ï¼ŒApifox ä¼šæ˜¾ç¤ºä¸€ç³»åˆ—é…ç½®é€‰é¡¹ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š

#### å¯¼å…¥ç›®æ ‡è®¾ç½®

- **ç›®æ ‡åˆ†æ”¯**: é€‰æ‹©ä¸»åˆ†æ”¯ï¼ˆé€šå¸¸æ˜¯ `main`ï¼‰
- **å¯¼å…¥åˆ°**: 
  - å¯ä»¥é€‰æ‹©å¯¼å…¥åˆ°å·²æœ‰æ¨¡å—
  - æˆ–è€…åˆ›å»ºæ–°æ¨¡å—å­˜æ”¾å¯¼å…¥çš„æ¥å£

#### æ¥å£å’Œç”¨ä¾‹è®¾ç½®

- **è‡ªåŠ¨ç”Ÿæˆæ¥å£ç”¨ä¾‹**: âœ… **æ¨èå¼€å¯**
  - å¦‚æœå¯¼å…¥çš„æ–‡æ¡£ä¸åŒ…å«å…·ä½“çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¼€å¯å Apifox ä¼šä¸ºæ¯ä¸ªæ¥å£è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„"æˆåŠŸ"ç”¨ä¾‹

- **å¯¼å…¥ Servers ä¸ºç¯å¢ƒ**: âœ… **æ¨èå¼€å¯**
  - ä¼šå°†æ–‡æ¡£ä¸­å®šä¹‰çš„æœåŠ¡å™¨åœ°å€ï¼ˆå¦‚ `http://localhost:8080`ã€`http://192.168.3.47:8080`ï¼‰è‡ªåŠ¨åˆ›å»ºä¸ºé¡¹ç›®ä¸­çš„ä¸åŒç¯å¢ƒ
  - æ–¹ä¾¿åœ¨ä¸åŒç¯å¢ƒé—´åˆ‡æ¢æµ‹è¯•

#### å®‰å…¨å’Œé‰´æƒå¤„ç†

- **å¯¼å…¥ Security Scheme**: âœ… **æ¨èå¼€å¯**
  - ä¼šå°†æ–‡æ¡£ä¸­å®šä¹‰çš„å…¨å±€é‰´æƒé…ç½®ï¼ˆBearer Tokenï¼‰å¯¼å…¥åˆ° Apifox é¡¹ç›®çš„ Auth è®¾ç½®
  - å¯¹äºæœªæ˜ç¡®è®¾ç½® Security çš„æ¥å£ï¼Œå»ºè®®é€‰æ‹©ï¼š**ç»§æ‰¿çˆ¶çº§ç›®å½•çš„ Auth é…ç½®**

> ğŸ’¡ **æç¤º**: æœ¬é¡¹ç›®å·²åœ¨ OpenAPI é…ç½®ä¸­å®šä¹‰äº† Bearer Token è®¤è¯ï¼Œå¯¼å…¥åä¼šè‡ªåŠ¨åº”ç”¨ã€‚

#### å‘½åè§„åˆ™å’Œ Summary

- **æ¥å£ Summary ä¸ºç©º**: ä½¿ç”¨ `operationId`ï¼ˆé»˜è®¤ï¼‰æˆ– `path`
  - å»ºè®®ä½¿ç”¨é»˜è®¤çš„ `operationId`ï¼Œè¿™æ ·æ¥å£åç§°æ›´æ¸…æ™°

#### èµ„æºå†²çªå¤„ç†

**æ¥å£å†²çª**: å½“å¯¼å…¥çš„æ¥å£ä¸ç°æœ‰æ¥å£çš„æ–¹æ³•å’Œè·¯å¾„å®Œå…¨ç›¸åŒæ—¶
- **é¦–æ¬¡å¯¼å…¥**: é€‰æ‹©"è¦†ç›–å·²æœ‰æ¥å£"æˆ–"ä¿ç•™ä¸¤è€…"
- **æ›´æ–°å¯¼å…¥**: âœ… **æ¨èé€‰æ‹©"æ™ºèƒ½åˆå¹¶"**
  - ä¼šä¿ç•™æ—§æ¥å£å†…ä¿®æ”¹çš„ä¸­æ–‡åã€Mock è§„åˆ™ã€å‚æ•°è¯´æ˜å’Œæ¥å£çš„å“åº”ç¤ºä¾‹
  - åªæ›´æ–°æ¥å£å®šä¹‰ï¼Œä¸ä¼šä¸¢å¤±å·²æœ‰çš„è‡ªå®šä¹‰å†…å®¹

**æ•°æ®æ¨¡å‹å’Œç»„ä»¶å†²çª**: 
- **é¦–æ¬¡å¯¼å…¥**: é€‰æ‹©"è¦†ç›–"
- **æ›´æ–°å¯¼å…¥**: âœ… **æ¨èé€‰æ‹©"æ™ºèƒ½åˆå¹¶"**

#### ç›®å½•åŒæ­¥

- **ä¿æŒå·²æœ‰æ¥å£çš„ç›®å½•ä¸å˜**: 
  - é€‚ç”¨äºæ¥å£ç›®å½•ç»“æ„å·²ç»æ‰‹åŠ¨è°ƒæ•´å¥½çš„æƒ…å†µ
- **æ›´æ–°æ¥å£ç›®å½•**: 
  - é€‚ç”¨äºå¸Œæœ›ç›®å½•ç»“æ„ä¸ä»£ç ä¸­çš„ Controller ç»“æ„ä¿æŒä¸€è‡´çš„æƒ…å†µ

#### èµ„æºæ¸…ç†

- **ä¸åˆ é™¤**: âœ… **æ¨èé€‰æ‹©"ä¸åˆ é™¤"**ï¼ˆå®‰å…¨é€‰é¡¹ï¼‰
  - é¡¹ç›®ä¸­é‚£äº›åœ¨æ–°æ–‡ä»¶ä¸­ä¸å­˜åœ¨çš„æ—§èµ„æºä¼šè¢«ä¿ç•™ä¸‹æ¥
  - é¿å…è¯¯åˆ å·²æ·»åŠ çš„æµ‹è¯•ç”¨ä¾‹å’Œè‡ªå®šä¹‰æ–‡æ¡£
- **åˆ é™¤**: 
  - é€‚ç”¨äºå¸Œæœ›å®Œå…¨åŒæ­¥ï¼Œä¿æŒé¡¹ç›®ä¸å¯¼å…¥æºæ•°æ®å®Œå…¨ä¸€è‡´çš„æƒ…å†µ

### 3.2 æ–¹å¼äºŒï¼šé€šè¿‡æ–‡ä»¶å¯¼å…¥

1. å…ˆä¸‹è½½ OpenAPI JSON æ–‡ä»¶ï¼ˆè§æ­¥éª¤ 2ï¼‰
2. æ‰“å¼€ Apifox
3. ç‚¹å‡»"é¡¹ç›®è®¾ç½®" -> "å¯¼å…¥æ•°æ®"
4. é€‰æ‹©"OpenAPI/Swagger"
5. é€‰æ‹©"æ–‡ä»¶å¯¼å…¥"
6. é€‰æ‹©ä¸‹è½½çš„ `openapi.json` æ–‡ä»¶
7. ç‚¹å‡»"å¼€å§‹å¯¼å…¥"

### 3.3 æ–¹å¼ä¸‰ï¼šé€šè¿‡ Git ä»“åº“å¯¼å…¥

1. å°† OpenAPI JSON æ–‡ä»¶æäº¤åˆ° Git ä»“åº“
2. åœ¨ Apifox ä¸­é€‰æ‹©"Git ä»“åº“å¯¼å…¥"
3. é…ç½® Git ä»“åº“åœ°å€
4. é€‰æ‹© OpenAPI JSON æ–‡ä»¶è·¯å¾„
5. è®¾ç½®åŒæ­¥é¢‘ç‡ï¼ˆå»ºè®®ï¼šæ¯æ¬¡æ¨é€æ—¶åŒæ­¥ï¼‰

---

## 4. é…ç½®è®¤è¯

### 4.1 é…ç½® Token è®¤è¯

å¯¼å…¥åˆ° Apifox åï¼Œéœ€è¦é…ç½® Token è®¤è¯ï¼š

1. æ‰“å¼€ Apifox é¡¹ç›®è®¾ç½®
2. è¿›å…¥"è®¤è¯é…ç½®"
3. æ·»åŠ "Bearer Token"è®¤è¯
4. Token åç§°è®¾ç½®ä¸º: `token`
5. Token å€¼å¯ä»¥ä»ç™»å½•æ¥å£è·å–

### 4.2 æµ‹è¯•ç™»å½•æ¥å£

1. è°ƒç”¨ç™»å½•æ¥å£ï¼š`POST /api/user/login`
2. è¯·æ±‚ä½“ï¼š
   ```json
   {
     "email": "diy4869@gmail.com",
     "password": "123456"
   }
   ```
3. ä»å“åº”ä¸­è·å– `token` å€¼
4. å°† `token` é…ç½®åˆ° Apifox çš„ç¯å¢ƒå˜é‡ä¸­

### 4.3 ä½¿ç”¨ç¯å¢ƒå˜é‡

åœ¨ Apifox ä¸­é…ç½®ç¯å¢ƒå˜é‡ï¼š

- **å˜é‡å**: `token`
- **å˜é‡å€¼**: ä»ç™»å½•æ¥å£è·å–çš„ token
- **ä½œç”¨åŸŸ**: å…¨å±€æˆ–é¡¹ç›®çº§åˆ«

---

## 5. API æ–‡æ¡£ç»“æ„

### 5.1 æ¥å£åˆ†ç»„

å¯¼å…¥åï¼ŒApifox ä¼šæ ¹æ® Controller è‡ªåŠ¨åˆ†ç»„ï¼š

- **ç”µå½±ç›¸å…³æ¥å£** (`MovieController`)
  - ç”µå½±åˆ—è¡¨
  - ç”µå½±è¯¦æƒ…
  - ç”µå½±ç‰ˆæœ¬åˆ—è¡¨
  - ç”µå½±è§’è‰²åˆ—è¡¨
  - ç”µå½±æ¼”èŒå‘˜åˆ—è¡¨
  - ç”µå½±è§„æ ¼åˆ—è¡¨

- **åœºæ¬¡ç›¸å…³æ¥å£** (`MovieShowTimeController`)
  - åœºæ¬¡åˆ—è¡¨
  - åœºæ¬¡è¯¦æƒ…
  - é€‰åº§ä¿å­˜
  - é€‰åº§å–æ¶ˆ
  - ç”¨æˆ·é€‰åº§åˆ—è¡¨
  - é€‰åº§åˆ—è¡¨

- **è®¢å•ç›¸å…³æ¥å£** (`MovieOrderController`)
  - åˆ›å»ºè®¢å•
  - è®¢å•è¯¦æƒ…
  - è®¢å•åˆ—è¡¨
  - æ”¯ä»˜è®¢å•
  - å–æ¶ˆè®¢å•
  - è®¢å•è¶…æ—¶
  - æˆ‘çš„ç¥¨æ®

- **ç”¨æˆ·ç›¸å…³æ¥å£** (`UserController`)
  - ç”¨æˆ·ç™»å½•
  - ç”¨æˆ·æ³¨å†Œ
  - ç”¨æˆ·è¯¦æƒ…
  - ç”¨æˆ·è®¢å•åˆ—è¡¨
  - ç”¨æˆ·ç™»å‡º

- **å½±é™¢ç›¸å…³æ¥å£** (`CinemaController`)
  - å½±é™¢åˆ—è¡¨
  - å½±é™¢è¯¦æƒ…
  - å½±é™¢è§„æ ¼
  - å½±é™¢æ’ç‰‡

- **App ç«¯æ¥å£** (`AppMovieController`)
  - æ­£åœ¨çƒ­æ˜ 
  - å³å°†ä¸Šæ˜ 
  - ç”µå½±åœºæ¬¡
  - ç”µå½±æ¼”èŒå‘˜

### 5.2 æ•°æ®æ¨¡å‹

å¯¼å…¥åï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹æ•°æ®æ¨¡å‹ï¼š

- `MovieResponse` - ç”µå½±å“åº”
- `MovieVersionResponse` - ç”µå½±ç‰ˆæœ¬å“åº”
- `MovieShowTimeDetail` - åœºæ¬¡è¯¦æƒ…
- `OrderListResponse` - è®¢å•åˆ—è¡¨å“åº”
- `UserDetail` - ç”¨æˆ·è¯¦æƒ…
- `RestBean<T>` - ç»Ÿä¸€å“åº”æ ¼å¼
- ç­‰ç­‰...

---

## 6. æ›´æ–°æ–‡æ¡£

### 6.1 è‡ªåŠ¨æ›´æ–°

å¦‚æœä½¿ç”¨ URL å¯¼å…¥ï¼ŒApifox ä¼šå®šæœŸåŒæ­¥æ–‡æ¡£ã€‚

### 6.2 æ‰‹åŠ¨æ›´æ–°

1. é‡æ–°ä¸‹è½½æœ€æ–°çš„ OpenAPI JSON
2. åœ¨ Apifox ä¸­é€‰æ‹©"é‡æ–°å¯¼å…¥"
3. é€‰æ‹©æ›´æ–°åçš„æ–‡ä»¶

### 6.3 å¢é‡æ›´æ–°

Apifox æ”¯æŒå¢é‡æ›´æ–°ï¼Œåªæ›´æ–°æœ‰å˜åŒ–çš„æ¥å£ï¼Œä¸ä¼šåˆ é™¤å·²æ·»åŠ çš„æµ‹è¯•ç”¨ä¾‹å’Œæ–‡æ¡£æ³¨é‡Šã€‚

---

## 7. è‡ªå®šä¹‰æ–‡æ¡£

### 7.1 æ·»åŠ æ¥å£æè¿°

åœ¨ Controller æ–¹æ³•ä¸Šæ·»åŠ  `@Operation` æ³¨è§£ï¼š

```java
@Operation(summary = "åˆ›å»ºè®¢å•", description = "æ ¹æ®å·²é€‰åº§ä½åˆ›å»ºç”µå½±ç¥¨è®¢å•")
@PostMapping(ApiPaths.Common.Order.CREATE)
public RestBean<MovieOrder> createOrder(@RequestBody @Validated MovieOrderSaveQuery query) {
    // ...
}
```

### 7.2 æ·»åŠ å‚æ•°æè¿°

åœ¨å‚æ•°ä¸Šæ·»åŠ  `@Parameter` æ³¨è§£ï¼š

```java
@Operation(summary = "ç”µå½±è¯¦æƒ…")
@GetMapping(ApiPaths.Common.Movie.DETAIL)
public RestBean<MovieResponse> detail(
    @Parameter(description = "ç”µå½±ID", required = true, example = "1")
    @RequestParam("id") Integer id
) {
    // ...
}
```

### 7.3 æ·»åŠ å“åº”ç¤ºä¾‹

ä½¿ç”¨ `@ApiResponse` æ³¨è§£ï¼š

```java
@Operation(summary = "åˆ›å»ºè®¢å•")
@ApiResponses(value = {
    @ApiResponse(responseCode = "200", description = "åˆ›å»ºæˆåŠŸ",
        content = @Content(schema = @Schema(implementation = MovieOrder.class))),
    @ApiResponse(responseCode = "400", description = "å‚æ•°é”™è¯¯"),
    @ApiResponse(responseCode = "401", description = "æœªç™»å½•"),
    @ApiResponse(responseCode = "500", description = "æœåŠ¡å™¨é”™è¯¯")
})
@PostMapping(ApiPaths.Common.Order.CREATE)
public RestBean<MovieOrder> createOrder(@RequestBody @Validated MovieOrderSaveQuery query) {
    // ...
}
```

### 7.4 æ·»åŠ è¯·æ±‚ä½“ç¤ºä¾‹

ä½¿ç”¨ `@Schema` æ³¨è§£ï¼š

```java
@Schema(description = "åˆ›å»ºè®¢å•è¯·æ±‚", example = "{\"movieShowTimeId\": 1, \"seat\": [...]}")
public class MovieOrderSaveQuery {
    // ...
}
```

---

## 8. å¸¸è§é—®é¢˜

### 8.1 æ–‡æ¡£æ— æ³•è®¿é—®

**é—®é¢˜**: è®¿é—® `http://localhost:8080/swagger-ui.html` æ˜¾ç¤º 404

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥é¡¹ç›®æ˜¯å¦æ­£å¸¸å¯åŠ¨
2. æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆé»˜è®¤ 8080ï¼‰
3. æ£€æŸ¥æ˜¯å¦æœ‰é˜²ç«å¢™é˜»æ­¢è®¿é—®
4. ç¡®è®¤ SpringDoc OpenAPI ä¾èµ–å·²æ·»åŠ 

### 8.2 å¯¼å…¥åæ¥å£ç¼ºå¤±

**é—®é¢˜**: å¯¼å…¥åˆ° Apifox åï¼Œéƒ¨åˆ†æ¥å£æœªæ˜¾ç¤º

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ Controller æ˜¯å¦æ·»åŠ äº† `@RestController` æ³¨è§£
2. æ£€æŸ¥è·¯å¾„æ˜ å°„æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æ˜¯å¦æœ‰ `@Hidden` æ³¨è§£éšè—äº†æ¥å£
4. å°è¯•ä½¿ç”¨"æ‰€æœ‰æ¥å£"åˆ†ç»„å¯¼å…¥

### 8.3 è®¤è¯å¤±è´¥

**é—®é¢˜**: åœ¨ Apifox ä¸­è°ƒç”¨æ¥å£è¿”å› 401

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤å·²é…ç½® Token è®¤è¯
2. ç¡®è®¤ Token å€¼æ­£ç¡®ï¼ˆå¯ä»¥ä»ç™»å½•æ¥å£è·å–ï¼‰
3. ç¡®è®¤ Token æœªè¿‡æœŸ
4. æ£€æŸ¥ Token æ˜¯å¦æ”¾åœ¨è¯·æ±‚å¤´ä¸­ï¼ˆåç§°åº”ä¸º `token`ï¼‰

### 8.4 å¯¼å…¥æ—¶å‡ºç°"æ•°æ®æ ¼å¼ä¸æ­£ç¡®"é”™è¯¯

**é—®é¢˜**: åœ¨ Apifox ä¸­å¯¼å…¥æ—¶æç¤º"æ•°æ®æ ¼å¼ä¸æ­£ç¡®"æˆ–"æ•°æ®è§£æå‡ºé”™"

**å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ**:

1. **URL æ ¼å¼é”™è¯¯**:
   - âŒ é”™è¯¯: ä½¿ç”¨äº† Swagger UI çš„ URLï¼ˆå¦‚ `http://localhost:8080/swagger-ui.html`ï¼‰
   - âœ… æ­£ç¡®: å¿…é¡»ä½¿ç”¨ OpenAPI JSON çš„ URLï¼ˆå¦‚ `http://localhost:8080/v3/api-docs`ï¼‰
   - ğŸ“– å‚è€ƒ: [Apifox å®˜æ–¹æ–‡æ¡£ - URL å¯¼å…¥](https://docs.apifox.com/doc-5174534)

2. **æœåŠ¡æœªå¯åŠ¨æˆ–æ— æ³•è®¿é—®**:
   - ç¡®è®¤æœåŠ¡æ­£åœ¨è¿è¡Œ
   - åœ¨æµè§ˆå™¨ä¸­å…ˆè®¿é—® `http://localhost:8080/v3/api-docs` éªŒè¯æ˜¯å¦èƒ½æ­£å¸¸è¿”å› JSON
   - å¦‚æœ Apifox å’ŒæœåŠ¡å™¨ä¸åœ¨åŒä¸€å°æœºå™¨ï¼Œä½¿ç”¨å®é™…çš„æœåŠ¡å™¨ IP åœ°å€ï¼ˆå¦‚ `http://192.168.3.47:8080/v3/api-docs`ï¼‰

3. **ç½‘ç»œè¿æ¥é—®é¢˜**:
   - æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å…è®¸è®¿é—® 8080 ç«¯å£
   - æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦ç»‘å®šåˆ° `0.0.0.0`ï¼ˆåœ¨ `application.yml` ä¸­é…ç½® `server.address: 0.0.0.0`ï¼‰

4. **OpenAPI æ–‡æ¡£æ ¼å¼é—®é¢˜**:
   - å¦‚æœä½¿ç”¨æ–‡ä»¶å¯¼å…¥ï¼Œç¡®è®¤æ–‡ä»¶æ˜¯æœ‰æ•ˆçš„ JSON æ ¼å¼
   - å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—® OpenAPI URLï¼Œå¤åˆ¶å†…å®¹åˆ° JSON æ ¼å¼åŒ–å·¥å…·éªŒè¯

5. **ä¸­æ–‡è·¯å¾„ç¼–ç é—®é¢˜**:
   - å¦‚æœä½¿ç”¨ä¸­æ–‡åˆ†ç»„è·¯å¾„ï¼ˆå¦‚ `/v3/api-docs/æ‰€æœ‰æ¥å£`ï¼‰ï¼Œç¡®ä¿ URL ç¼–ç æ­£ç¡®
   - å»ºè®®ä½¿ç”¨é»˜è®¤è·¯å¾„ `/v3/api-docs`ï¼ˆåŒ…å«æ‰€æœ‰æ¥å£ï¼‰é¿å…ç¼–ç é—®é¢˜

### 8.5 æ–‡æ¡£ä¸å®Œæ•´

**é—®é¢˜**: æ¥å£æè¿°ã€å‚æ•°è¯´æ˜ç­‰ç¼ºå¤±

**è§£å†³æ–¹æ¡ˆ**:
1. åœ¨ä»£ç ä¸­æ·»åŠ  `@Operation`ã€`@Parameter`ã€`@Schema` ç­‰æ³¨è§£
2. åœ¨å®ä½“ç±»ä¸­æ·»åŠ  `@Schema` æ³¨è§£æè¿°å­—æ®µ
3. é‡æ–°ç”Ÿæˆå¹¶å¯¼å…¥æ–‡æ¡£

---

## 9. æœ€ä½³å®è·µ

### 9.1 æ·»åŠ è¯¦ç»†çš„æ¥å£æ–‡æ¡£

- ä¸ºæ¯ä¸ªæ¥å£æ·»åŠ  `@Operation` æ³¨è§£ï¼ŒåŒ…å« `summary` å’Œ `description`
- ä¸ºæ¯ä¸ªå‚æ•°æ·»åŠ  `@Parameter` æ³¨è§£ï¼Œè¯´æ˜å‚æ•°ç”¨é€”å’Œç¤ºä¾‹
- ä¸ºå®ä½“ç±»æ·»åŠ  `@Schema` æ³¨è§£ï¼Œæè¿°æ•°æ®æ¨¡å‹

### 9.2 æä¾›è¯·æ±‚/å“åº”ç¤ºä¾‹

- ä½¿ç”¨ `@ApiResponse` æä¾›å“åº”ç¤ºä¾‹
- åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨ `@Schema` çš„ `example` å±æ€§æä¾›ç¤ºä¾‹å€¼

### 9.3 åˆ†ç»„ç®¡ç†

- ä½¿ç”¨ä¸åŒçš„åˆ†ç»„ï¼ˆé€šç”¨æ¥å£ã€ç®¡ç†å‘˜æ¥å£ã€App æ¥å£ï¼‰ä¾¿äºç®¡ç†
- åœ¨ Apifox ä¸­åˆ›å»ºå¯¹åº”çš„ç›®å½•ç»“æ„

### 9.4 ç‰ˆæœ¬æ§åˆ¶

- å°† OpenAPI JSON æ–‡ä»¶æäº¤åˆ° Git ä»“åº“
- ä½¿ç”¨ Git ä»“åº“å¯¼å…¥åŠŸèƒ½ï¼Œå®ç°æ–‡æ¡£è‡ªåŠ¨åŒæ­¥

---

## 10. ç›¸å…³èµ„æº

- [SpringDoc OpenAPI å®˜æ–¹æ–‡æ¡£](https://springdoc.org/)
- [OpenAPI è§„èŒƒ](https://swagger.io/specification/)
- [Apifox å®˜æ–¹æ–‡æ¡£](https://apifox-openapi.readme.io/)

---

## 11. å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: å¯åŠ¨é¡¹ç›®

```bash
cd java-backend
./mvnw spring-boot:run
```

### æ­¥éª¤ 2: è®¿é—® Swagger UI

æµè§ˆå™¨æ‰“å¼€: http://localhost:8080/swagger-ui.html

### æ­¥éª¤ 3: ä¸‹è½½ OpenAPI JSON

è®¿é—®: http://localhost:8080/v3/api-docs/æ‰€æœ‰æ¥å£

ä¿å­˜ä¸º `openapi.json`

### æ­¥éª¤ 4: å¯¼å…¥åˆ° Apifox

1. æ‰“å¼€ Apifox
2. é¡¹ç›®è®¾ç½® -> å¯¼å…¥æ•°æ® -> OpenAPI/Swagger
3. é€‰æ‹©æ–‡ä»¶å¯¼å…¥
4. é€‰æ‹© `openapi.json`
5. ç‚¹å‡»"å¼€å§‹å¯¼å…¥"

### æ­¥éª¤ 5: é…ç½®è®¤è¯

1. è°ƒç”¨ç™»å½•æ¥å£è·å– token
2. åœ¨ Apifox ç¯å¢ƒå˜é‡ä¸­é…ç½® token
3. å¼€å§‹æµ‹è¯•æ¥å£

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2025-01-17  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**ç»´æŠ¤çŠ¶æ€**: æŒç»­æ›´æ–°
